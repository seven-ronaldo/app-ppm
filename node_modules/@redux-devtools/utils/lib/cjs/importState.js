"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.importState = importState;
var _jsan = _interopRequireDefault(require("jsan"));
var _serialize = require("@redux-devtools/serialize");
function importState(state, _ref) {
  let {
    serialize
  } = _ref;
  if (!state) return undefined;
  let parse = _jsan.default.parse;
  if (serialize) {
    if (serialize.immutable) {
      parse = v => _jsan.default.parse(v, (0, _serialize.immutableSerialize)(serialize.immutable, serialize.refs).reviver);
    } else if (serialize.reviver) {
      parse = v => _jsan.default.parse(v, serialize.reviver);
    }
  }
  let preloadedState;
  let nextLiftedState = parse(state);
  if (nextLiftedState.payload) {
    if (nextLiftedState.preloadedState) preloadedState = parse(nextLiftedState.preloadedState);
    nextLiftedState = parse(nextLiftedState.payload);
  }
  return {
    nextLiftedState,
    preloadedState
  };
}